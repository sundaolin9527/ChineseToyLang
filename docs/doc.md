# 语法规则
# 1.1 基本词类
标识符 = 中文标识 | 字母 (字母|数字|'_')* ;
中文标识 = 中文汉字 (中文汉字|字母|数字|'_')* ;
数字 = 整数 | 浮点数 ;
整数 = 数字+ ;
浮点数 = 数字+ '.' 数字+ ;

字符串 = '"' (非引号字符 | 转义序列)* '"' ;
字符 = "'" (非撇号字符 | 转义序列) "'" ;

布尔值 = "真" | "假" ;
空值 = "空" ;

关键字 = "令" | "恒" | "函" | "返" | "若" | "亦" | "则"
        | "当" | "遍" | "撤" | "过" | "导入" | "导出" | "组" | "团"
        | "真" | "假" | "空"

# 1.2 运算符
运算符 = "+" | "-" | "*" | "/" | "%" | "**" 
       | "==" | "!=" | ">" | "<" | ">=" | "<=" 
       | "&&" | "||" | "!" 
       | "=" | "+=" | "-=" | "*=" | "/=" | "%="

# 1.3 分隔符
分隔符 = "(" | ")" | "[" | "]" | "{" | "}" 
       | "," | ";" | ":" | "=>" | "..."


# 语法规则
# 2.1 程序结构
程序 = 语句+ ;

语句 = 变量声明
     | 函数声明
     | 表达式语句
     | 控制语句
     | 块语句
     | 返回语句
     | 导入语句
     | 导出语句 ;

# 2.2 声明
变量声明 = ("令" | "恒") 标识符 ("=" 表达式)? ";" ;
函数声明 = "函" 标识符 "(" 参数列表? ")" 块语句 ;
参数列表 = 参数 ("," 参数)* ;
参数 = 标识符 ("=" 表达式)? ;

# 2.3 表达式
表达式 = 赋值表达式 ;
赋值表达式 = 逻辑或表达式 (赋值运算符 赋值表达式)? ;
逻辑或表达式 = 逻辑与表达式 ("||" 逻辑与表达式)* ;
逻辑与表达式 = 相等表达式 ("&&" 相等表达式)* ;
相等表达式 = 比较表达式 (("==" | "!=") 比较表达式)* ;
比较表达式 = 加减表达式 ((">" | "<" | ">=" | "<=") 加减表达式)* ;
加减表达式 = 乘除表达式 (("+" | "-") 乘除表达式)* ;
乘除表达式 = 指数表达式 (("*" | "/" | "%") 指数表达式)* ;
指数表达式 = 一元表达式 ("**" 一元表达式)* ;
一元表达式 = ("+" | "-" | "!")* 主表达式 ;
主表达式 = 字面量
         | 标识符
         | "(" 表达式 ")"
         | 函数调用
         | 数组访问
         | 对象访问
         | 匿名函数 ;
 
 控制语句 = 条件语句
         | 循环语句
         | 跳转语句 ;

# 2.4 其他表达式
函数调用 = 表达式 "(" 参数列表? ")" ;
数组访问 = 表达式 "[" 表达式 "]" ;
对象访问 = 表达式 "." 标识符 ;
匿名函数 = "(" 参数列表? ")" "=>" (表达式 | 块语句) ;

# 2.5 控制结构     
条件语句 = "若" "(" 表达式 ")" 语句 ("则" 语句)? ;
循环语句 = ("当" "(" 表达式 ")" 语句)
         | ("遍" "(" 初始化? ";" 条件? ";" 更新? ")" 语句) ;
跳转语句 = "撤" ";" | "过" ";" ;

# 2.6 其他语句
返回语句 = "返" 表达式? ";" ;
块语句 = "{" 语句* "}" ;
导入语句 = "导入" 字符串 ";" ;
导出语句 = "导出" 标识符 ";" ;

# 2.7 类型系统
类型 = "整数" | "浮点数" | "布尔" | "字符串" 
         | "数组"
         | "函数"
         | 标识符 ;
# 结构
结构体 = "组" 标识符 "{" 成员列表 "}" ";"
成员列表 = 成员 | 成员 成员列表
成员 = 标识符
联合体 = "团" 标识符 "{" 成员列表 "}" ";"


# 示例用法
见 tests/examples/test.txt